running build_ext
/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/utils/cpp_extension.py:424: UserWarning: There are no g++ version bounds defined for CUDA version 12.1
  warnings.warn(f'There are no {compiler_name} version bounds defined for CUDA version {cuda_str_version}')
building 'fused_adam' extension
creating /ssd1/siyuanch/workspace/LSP-Offload/kernels/build
creating /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310
/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/utils/cpp_extension.py:1965: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation. 
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Emitting ninja build file /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310/build.ninja...
Compiling objects...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
[1/3] c++ -MMD -MF /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310/fusedAdam.o.d -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include/TH -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include/THC -I/usr/local/cuda-12.1/include -I/ssd1/siyuanch/.venv/llm/include -I/home/siyuanch/ssd/local/python3.10/include/python3.10 -c -c /ssd1/siyuanch/workspace/LSP-Offload/kernels/fusedAdam.cpp -o /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310/fusedAdam.o -fopenmp -mavx2 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=fused_adam -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++17
[2/3] c++ -MMD -MF /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310/fusedAdam_cpu.o.d -pthread -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include/TH -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include/THC -I/usr/local/cuda-12.1/include -I/ssd1/siyuanch/.venv/llm/include -I/home/siyuanch/ssd/local/python3.10/include/python3.10 -c -c /ssd1/siyuanch/workspace/LSP-Offload/kernels/fusedAdam_cpu.cpp -o /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310/fusedAdam_cpu.o -fopenmp -mavx2 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=fused_adam -D_GLIBCXX_USE_CXX11_ABI=0 -std=c++17
/ssd1/siyuanch/workspace/LSP-Offload/kernels/fusedAdam_cpu.cpp: In function ‘void fused_adam_cpu_impl(float*, float*, float*, float, float, float, float, float, float, size_t)’:
/ssd1/siyuanch/workspace/LSP-Offload/kernels/fusedAdam_cpu.cpp:12:23: warning: comparison of integer expressions of different signedness: ‘int’ and ‘const size_t’ {aka ‘const long unsigned int’} [-Wsign-compare]
   12 |     for (int i = 0; i < length; i += 8) {
      |                     ~~^~~~~~~~
[3/3] /usr/local/cuda-12.1/bin/nvcc --generate-dependencies-with-compile --dependency-output /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310/fusedAdam_cuda.o.d -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include/torch/csrc/api/include -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include/TH -I/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/include/THC -I/usr/local/cuda-12.1/include -I/ssd1/siyuanch/.venv/llm/include -I/home/siyuanch/ssd/local/python3.10/include/python3.10 -c -c /ssd1/siyuanch/workspace/LSP-Offload/kernels/fusedAdam_cuda.cu -o /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310/fusedAdam_cuda.o -D__CUDA_NO_HALF_OPERATORS__ -D__CUDA_NO_HALF_CONVERSIONS__ -D__CUDA_NO_BFLOAT16_CONVERSIONS__ -D__CUDA_NO_HALF2_OPERATORS__ --expt-relaxed-constexpr --compiler-options ''"'"'-fPIC'"'"'' -O2 -DTORCH_API_INCLUDE_EXTENSION_H '-DPYBIND11_COMPILER_TYPE="_gcc"' '-DPYBIND11_STDLIB="_libstdcpp"' '-DPYBIND11_BUILD_ABI="_cxxabi1011"' -DTORCH_EXTENSION_NAME=fused_adam -D_GLIBCXX_USE_CXX11_ABI=0 -gencode=arch=compute_75,code=sm_75 -gencode=arch=compute_89,code=compute_89 -gencode=arch=compute_89,code=sm_89 -std=c++17
creating build/lib.linux-x86_64-cpython-310
g++ -pthread -shared /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310/fusedAdam.o /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310/fusedAdam_cpu.o /ssd1/siyuanch/workspace/LSP-Offload/kernels/build/temp.linux-x86_64-cpython-310/fusedAdam_cuda.o -L/ssd1/siyuanch/.venv/llm/lib/python3.10/site-packages/torch/lib -L/usr/local/cuda-12.1/lib64 -L/home/siyuanch/ssd/local/python3.10/lib -lc10 -ltorch -ltorch_cpu -ltorch_python -lcudart -lc10_cuda -ltorch_cuda -o build/lib.linux-x86_64-cpython-310/fused_adam.cpython-310-x86_64-linux-gnu.so
copying build/lib.linux-x86_64-cpython-310/fused_adam.cpython-310-x86_64-linux-gnu.so -> 
